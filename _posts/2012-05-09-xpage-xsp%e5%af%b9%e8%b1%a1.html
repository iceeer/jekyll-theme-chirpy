---
layout: post
status: publish
published: true
title: XPage XSP对象
author:
  display_name: iceeer
  login: iceeer
  email: superuser@xystoy.com
  url: ''
author_login: iceeer
author_email: superuser@xystoy.com
wordpress_id: 1526
wordpress_url: http://iceeer.huiq.org/?p=1526
date: '2012-05-09 10:49:44 +0800'
date_gmt: '2012-05-09 02:49:44 +0800'
categories:
- 开发
- Domino/Notes
tags:
- XPage
- XSP
comments: []
---
<ul>
<li><code>XSP.addOnLoad( listener )</code><br />Adds a function "listener" to the code that is executed when loading a page.</li>
<li><code>XSP.attachClientScript(targetClientId, _event, clientScript), xsp.attachClientFunction(targetClientId, _event, clientSideScriptName)</code><br />Attaches a function to a client element for a specific event. If the function exists use attachClientFunction. If the code is inside the variable "clientScript" use attachClientScript</li>
<li><code>XSP.setSubmitValue(value)</code><br />Overwrites what a submission is sending back to the server. Use with caution!</li>
<li><code>XSP.canSubmit()</code><br />Returns true/false. If a page has been recently submitted it returns false. Good way to prevent submit button double click hazards. To manually set it to true call&nbsp;<code>XSP.allowSubmit()</code></li>
<li><code>XSP.addPreSubmitListener(formid, listener, clientId, scriptid)</code><br />Adds a function (the listener) that runs before the form (formid) is submitted. Great way to run cleanup code in custom controls to make them self contained. Also a good way to have code run only for a specific button (clientid) rather than onsubmit in any case. The scriptid helps to check if the listener has been loaded already (e.g. on partial page refresh) to avoid duplicate loads. If listener returns false submission does not happen. Runs after the client side validators.</li>
<li><code>XSP.addQuerySubmitListener(formId, listener, clientId, scriptId)</code><br />Same as above but runs before the validators</li>
<li><code>XSP.alert(message), XSP.error(message), XSP.confirm(question)</code><br />Currently this are wrappers around alert() and dojo.confirm(). Using this functions has the advantage of instant beautifications once the XSP object gets upgraded</li>
<li><code>XSP.attachValidator(clientId, validator, converter)</code><br />Allows to attach a validator to a client object. The better way to validate than writing code in the onSubmit event. Admittingly a little more complex. The function warrants its own blog entry (stay tuned)</li>
<li><code>XSP.validateAllFields(true|false)</code><br />Default for this is false. When set to true all client side validation is executed not only all until the first error. You will get a number of prompts. Makes sense with an overwritten validation function, but that's a story for another time.</li>
<li><code>XSP.attachEvent(clientId, targetClientId, _event, clientSideScriptName, submit, valmode, execId)</code><br />Attaches events to client side elements. The clientId is the element, the targetClientId the target for a partial refresh, _event the event to attach. More in a future blog entry.</li>
<li><code>XSP.fireEvent(evt, clientId, targetId, clientSideScriptName, submit, valmode, execId)</code><br />Allows to trigger an event script.</li>
<li><code>XSP.attachPartial(clientId, targetId, execId, eventName, scriptName, valmode, refreshId, onStart, onComplete, onError)</code><br />Attaches events to client side elements. The clientId is the element, the targetId the target for a partial refresh, eventName the event to attach. on(Start|Complete|Error) the functions to run locally around the ajax event. More in a future blog entry.</li>
<li><code>XSP.partialRefreshGet(refreshId, options), XSP.partialRefreshPost(refreshId, options)&nbsp;</code><br />Triggers a partial refresh manually. For POST the refreshId must point to a form, for get it can be any element with a partial refresh defines. The options object is quite interesting to examine. Includes parameters and functions to execute in the life cycle.</li>
<li><code>XSP.attachDirtyListener(clientId)</code><br />Listen to a specific field. If it changes consider the form "dirty". (<a href="http://www.persil.com/">Persil</a>&nbsp;to the rescue). Use<code>XSP.attachDirtyUnloadListener(message)</code>&nbsp;to set a message. Typically you use that for "Your form has changed, do you really want to navigate away" type of messages.</li>
<li><code>XSP.trim(string), XSP.startsWith(string, seachString), XSP.endsWith(string, searchString)</code><br />Convenience functions for string stuff.</li>
<li><code>XSP.serialize(object)</code><br />Takes an JavaScript object and returns a textual representation. Currently JSON, but might change.</li>
<li><code>XSP.toJson(object), XSP.fromJson(string)</code><br />Convert data from/to JSON format.</li>
<li><code>XSP.log(message)</code><br />Send a message to the local log. Used for debug (mostly)</li>
</ul>

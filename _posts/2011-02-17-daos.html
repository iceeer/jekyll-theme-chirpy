---
layout: post
status: publish
published: true
title: DAOS
author:
  display_name: iceeer
  login: iceeer
  email: superuser@xystoy.com
  url: ''
author_login: iceeer
author_email: superuser@xystoy.com
wordpress_id: 961
wordpress_url: http://iceeer.huiq.net/?p=961
date: '2011-02-17 15:51:22 +0800'
date_gmt: '2011-02-17 07:51:22 +0800'
categories:
- 开发
- Domino/Notes
tags:
- DAOS
- Domino
- 大数据库
- 数据库
- 邮箱
- 附件
comments: []
---
<p><strong>开启DAOS：</strong></p>
<p>在服务器文档开启DAOS、事务记录</p>
<p>notes.ini添加Create_R85_Databases=1 新创建的数据库使用高版本</p>
<p>8.5.2以上用来升级数据库版本可以使用：Load Compact -ODS&nbsp;</p>
<p>对单个数据库启用DAOS：</p>
<p>load compact -daos on &lt;数据库名&gt; 启用DAOS</p>
<p>load compact -c -daos on &lt;数据库名&gt;&nbsp;&nbsp; 升级数据库版本并对老文档附件进行处理</p>
<p><strong>DAOS命令</strong></p>
<p>Tell DAOSMgr Status：列举 DAOS 操作的状态以及 DAOS 全局信息，比如附件存储路径，删除没有文档引用附件的间隔等。</p>
<p>Tell DAOSMgr Status Dbsummary：列举服务器上所有启用 DAOS 的数据库状态，对附件的引用数目，如图 6 所示。</p>
<p>Tell DAOSMgr Status Catalog：列举 DAOS 中 catalog 的状态，版本等信息。</p>
<p>Tell DAOSMgr Status Databases：列举服务器上所有启动 DAOS 的数据库的详细信息，包括状态，上次引用与附件同步的时间，引用数目等，如图 7 所示。</p>
<p>Tell DAOSMgr Status database_name：列举某个数据库的 DAOS 信息和状态。</p>
<p>Tell DAOSMgr ListNLO &ndash; o outputfile_name ALL/MISSING database_name：列举指定数据库中所有（ALL）或者丢失（MISSING）的 NLO 引用，并将结果重定向到文件 outputfile_name 中。如果 NLO 文件损坏、删除或丢失，用此命令可以迅速定位，用备份的 NLO 文件进行恢复。</p>
<p>Tell DAOSMgr Prune day_number：删除没有文档引用的 NLO 文件。day_number 指定 NLO 已经没有任何引用但还存在服务器上的天数。如果此参数为 0，就表示立即清除所有没有引用的 NLO 文件。如果为非零，比如说 3，就是清除所有失去任何引用超过 3 天的 NLO 文件。值得注意的是，执行这个命令时，会覆盖前文提到的服务器文档&ldquo;Defer object deletion for&rdquo;的设置。</p>
<p>Tell DAOSMgr Resync：同步启用了 DAOS 数据库和 NLO 之间的引用关系。当从操作系统删除数据库，数据库恢复等操作发生后，需要同步 DAOS 引用关系，并在 daoscat.nsf 中更新。</p>
<div>&nbsp;</div>
<p><strong>升级客户端数据库版本</strong></p>
<div id="_mcePaste">NSF_UpdateODS=1 打开客户端时自动升级，升级信息显示在日记库</div>
<p><strong>DAOS相关文件</strong></p>
<p>.NLO 文件的文件名是附件内容的校验和码</p>
<p>DAOS Catalog（daoscat.nsf）来维护 DAOS 附件和其引用的维护，它记录了文档与附件之间的对应关系</p>
<p>设置DAOS_ENCRYPT_NLO=0 不对 .NLO 文件加密</p>
<p>load fixup -j</p>
<p><strong>禁用DAOS：</strong></p>
<p>服务器设置 - DAOS 设为禁用</p>
<p>DAOS_LOAD=1 去掉</p>
<p>链接：<a href="http://www-10.lotus.com/ldd/dominowiki.nsf/dx/DAOS_Deployment_Guide">IBM Lotus Domino Attachment and Object Service (DAOS) deployment guide</a></p>
<p><a href="http://www-10.lotus.com/ldd/dominowiki.nsf/dx/daos-quick-start-guide">DAOS Quick Start Guide</a></p>
